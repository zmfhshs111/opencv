# 실시간 얼굴 감지 및 프라이버시 보호 시스템

OpenCV를 사용한 실시간 얼굴 감지 및 모자이크/블러 효과 적용 프로그램입니다. 웹캠을 통해 실시간으로 얼굴을 감지하고 프라이버시 보호를 위한 효과를 적용할 수 있습니다.

## 주요 기능

- **실시간 얼굴 감지**: Haar Cascade 분류기를 사용한 빠른 얼굴 감지
- **두 가지 프라이버시 효과**:
  - 모자이크 효과 (Mosaic)
  - 가우시안 블러 효과 (Blur)
- **실시간 효과 조정**: 키보드를 통한 실시간 모드 변경 및 강도 조절
- **비디오 녹화**: 처리된 영상을 MP4 파일로 저장
- **이미지 캡처**: 현재 프레임을 이미지로 저장
- **성능 모니터링**: FPS 및 처리 시간 실시간 표시
- **디버그 모드**: 얼굴 감지 영역을 시각적으로 확인

## 필요 라이브러리

```bash
pip install opencv-python
pip install numpy
```

## 사용법

### 기본 실행
```bash
python face_detection.py
```

### 고급 옵션
```bash
python face_detection.py --camera 0 --mode blur --strength 25 --save-video --debug
```

## 명령줄 옵션

| 옵션 | 기본값 | 설명 |
|------|--------|------|
| `--camera` | 0 | 카메라 장치 번호 |
| `--mode` | mosaic | 효과 모드 (mosaic 또는 blur) |
| `--strength` | 20 | 모자이크/블러 강도 |
| `--min-size` | 20 | 감지할 최소 얼굴 크기 (픽셀) |
| `--scale` | 1.1 | 이미지 스케일 감소 비율 |
| `--neighbors` | 4 | 얼굴 감지 정확도 파라미터 |
| `--save-video` | False | 비디오 저장 활성화 |
| `--debug` | False | 디버그 창 표시 |

## 키보드 단축키

실행 중에 다음 키를 사용하여 프로그램을 제어할 수 있습니다:

| 키 | 기능 |
|---|------|
| `q` | 프로그램 종료 |
| `m` | 모자이크 모드로 전환 |
| `b` | 블러 모드로 전환 |
| `+` / `=` | 효과 강도 증가 |
| `-` / `_` | 효과 강도 감소 |
| `s` | 현재 프레임을 이미지로 저장 |
| `r` | 비디오 녹화 시작/중지 |
| `d` | 디버그 모드 토글 |

## 화면 정보

프로그램 실행 시 화면에 다음 정보가 표시됩니다:

- **Faces**: 감지된 얼굴 수
- **Mode**: 현재 효과 모드 및 강도
- **FPS**: 초당 프레임 수
- **Process**: 프레임 처리 시간 (밀리초)
- **REC**: 녹화 중일 때 표시되는 빨간 점

## 사용 예시

### 1. 기본 모자이크 효과
```bash
python face_detection.py
```

### 2. 블러 효과로 시작하고 비디오 저장
```bash
python face_detection.py --mode blur --save-video
```

### 3. 강한 모자이크 효과와 디버그 모드
```bash
python face_detection.py --mode mosaic --strength 30 --debug
```

### 4. 민감도 조정
```bash
python face_detection.py --scale 1.2 --neighbors 5 --min-size 30
```

## 파일 저장

- **이미지 저장**: `face_detection_YYYYMMDD_HHMMSS.jpg`
- **비디오 저장**: `face_detection_{mode}_YYYYMMDD_HHMMSS.mp4`

## 성능 최적화 팁

1. **카메라 해상도 조정**: 높은 해상도는 처리 속도를 느리게 합니다
2. **감지 파라미터 조정**: 
   - `--scale` 값을 높이면 속도는 빨라지지만 정확도가 떨어집니다
   - `--neighbors` 값을 낮추면 속도는 빨라지지만 오탐지가 늘어납니다
3. **최소 얼굴 크기 증가**: `--min-size`를 크게 하면 작은 얼굴을 무시하여 속도가 향상됩니다

## 문제 해결

### 카메라를 열 수 없는 경우
- 다른 프로그램에서 카메라를 사용 중인지 확인
- `--camera` 옵션으로 다른 카메라 장치 번호 시도 (1, 2, ...)

### 얼굴 감지가 잘 안 되는 경우
- 조명 환경 개선
- `--scale` 값을 1.05~1.3 사이로 조정
- `--neighbors` 값을 3~6 사이로 조정
- `--min-size` 값을 환경에 맞게 조정

### 성능이 느린 경우
- 디버그 모드 비활성화
- 카메라 해상도 낮추기
- `--scale` 값 증가 (1.2~1.3)

## 라이선스

이 프로젝트는 개인 및 교육 목적으로 자유롭게 사용할 수 있습니다.

## 주의사항

- 이 프로그램은 교육 및 개발 목적으로 제작되었습니다
- 타인의 프라이버시를 존중하며 사용해주세요
- 상업적 사용 시 관련 법규를 확인하시기 바랍니다
